# Main printer configuration for Custom CoreXY with dual Z motors
# BigTreeTech Octopus EX Max + Beacon3D Eddy Current Probe
# 400x400x400 print volume - High Speed Optimized
# Based on motor specs from https://github.com/JCorellaFSL/NecroCubicon

[include printer_base.cfg]
[include motor_specs.cfg]
[include beacon3d_probe.cfg]
[include dual_z_motors.cfg]
[include corexy_kinematics.cfg]
[include input_shaper.cfg]
[include fan_control.cfg]
[include leveling.cfg]
[include pid_tuning.cfg]
[include testing.cfg]
[include macros.cfg]

# ============================================================================
# PRINTER CONFIGURATION - HIGH SPEED OPTIMIZED
# ============================================================================

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 5000
max_accel_to_decel: 2500
max_z_velocity: 10
max_z_accel: 200

# ============================================================================
# STEPPER CONFIGURATION - OPTIMIZED FOR 17HS24-2104S & 17HE24-2104S
# ============================================================================

# CoreXY Stepper A (17HS24-2104S) - High speed optimized
[stepper_a]
step_pin: PB13
dir_pin: PB12
enable_pin: !PB14
step_distance: 0.0125
endstop_pin: ^PC0
position_endstop: 0
position_max: 400
homing_speed: 100
second_homing_speed: 20
homing_retract_dist: 5

# CoreXY Stepper B (17HS24-2104S) - High speed optimized
[stepper_b]
step_pin: PB10
dir_pin: PB2
enable_pin: !PB11
step_distance: 0.0125
endstop_pin: ^PC1
position_endstop: 0
position_max: 400
homing_speed: 100
second_homing_speed: 20
homing_retract_dist: 5

# Z Stepper 1 (17HE24-2104S) - Optimized for dual Z
[stepper_z]
step_pin: PB0
dir_pin: PC5
enable_pin: !PB1
step_distance: 0.04
endstop_pin: probe:z_virtual_endstop
position_max: 400
position_min: -5

# Z Stepper 2 (17HE24-2104S) - Synchronized with Z1
[stepper_z1]
step_pin: PA15
dir_pin: PA8
enable_pin: !PC6
step_distance: 0.04

# Extruder (17HS24-2104S) - High speed optimized
[extruder]
step_pin: PB3
dir_pin: PB4
enable_pin: !PD1
step_distance: 0.0025
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: PA1
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC4
control: pid
pid_Kp: 21.527
pid_Ki: 1.063
pid_Kd: 108.982
min_temp: 0
max_temp: 250
pressure_advance: 0.0
pressure_advance_smooth_time: 0.040

# ============================================================================
# HEATER CONFIGURATION
# ============================================================================

[heater_bed]
heater_pin: PA0
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC3
control: pid
pid_Kp: 54.027
pid_Ki: 0.770
pid_Kd: 948.182
min_temp: 0
max_temp: 130

# ============================================================================
# MISC PINS
# ============================================================================

[output_pin beeper]
pin: PA13
value: 0
shutdown_value: 0
cycle_time: 0.001

# ============================================================================
# INPUT SHAPER - OPTIMIZED FOR HIGH SPEED
# ============================================================================

[input_shaper]
shaper_freq_x: 60.0
shaper_freq_y: 60.0
shaper_type: mzv

# ============================================================================
# FILAMENT SENSOR (Optional)
# ============================================================================

# Uncomment if you have a filament sensor
# [filament_switch_sensor filament_sensor]
# switch_pin: ^PC2
# pause_on_runout: True
# runout_gcode: PAUSE

# ============================================================================
# NEOPIXEL (Optional - for LED strips)
# ============================================================================

# Uncomment if you have LED strips
# [neopixel led_strip]
# pin: PE0
# chain_count: 30
# color_order: GRB
# initial_RED: 0.0
# initial_GREEN: 0.0
# initial_BLUE: 0.0 